---
### Crafts and tests
## Prevents me from commenting/uncommenting/forgetting on final production files ^^'

# ---
# Currently working on: Playbook 4 / Init core services / Set up reverse proxy Traefik & hello world test
# ---

# You'll need the_builder_guy to have it's ssh key added to the local agent, cf. the_builder_guy generated documentation
# You'll need the_docker_guy  to have it's ssh key added to the local agent, cf. the_docker_guy  generated documentation

# ---

### TODO
## Local
# âœ… Manage required vars
# âœ… Generate a local README.md file w. vars
# âœ… Default vars overload template in test playbook
# âœ… Make a wordpress-stack.yml.j2 template file
#   ðŸ“Œ docker guy host cli > remove stack 'test-wordpress' and test generated file
#     volumes are generated automaticcally w. stack ? no need to create
# Manage generated vars
# Generate a local wordpress-stack.yml file using vars

## Builder guy
# Upload wordpress-stack.yml to host
# Remove local wordpress-stack.yml file

## Docker guy
# Volumes creation
  ## Create named volumes
  # docker volume create \
  #    --label fr.masamune.test-wordpress.client='masamune' \
  #    --label fr.masamune.test-wordpress.maintainer='masamune.code@gmail.com' \
  #    --label fr.masamune.test-wordpress.project='test service wordpress > mariadb' \
  #    --label fr.masamune.test-wordpress.type='test' \
  #    test--test-wordpress-masamune-fr--wordpress--db \
  # && \
  # docker volume create \
  #    --label fr.masamune.test-wordpress.client='masamune' \
  #    --label fr.masamune.test-wordpress.maintainer='masamune.code@gmail.com' \
  #    --label fr.masamune.test-wordpress.project='test service wordpress > wordpress' \
  #    --label fr.masamune.test-wordpress.type='test' \
  #    test--test-wordpress-masamune-fr--wordpress--files
  ## ANSIBLE > {{ project.type }}--{{ project.dashed_domain }}--wordpress--db
# Debug warning: ~1min to start (database creation)
# Start stack
# Automated ~Manual steps (wp-cli, etc.)

# ---

### Setup a WordPress stack
# Based on bitnami's WordPress & MariaDB images
#   https://hub.docker.com/r/bitnami/wordpress/
#   https://hub.docker.com/r/bitnami/mariadb/

# You'll need the_builder_guy to have it's ssh key added to the local agent, cf. the_builder_guy generated documentation
# You'll need the_docker_guy  to have it's ssh key added to the local agent, cf. the_docker_guy  generated documentation

### Locally
- name: 'Setup a WordPress stack / Locally / Generate files'
  hosts: 127.0.0.1
  # vars:
  #   database:
  #     image: 'bitnami/mariadb:10.3__overload_test'
  #     MARIADB_DATABASE: 'bitnami_wordpress_drdS87QVpvADFw5W__overload_test'
  #     MARIADB_PASSWORD: 'G6Sn3VaLqf2DDL9W__overload_test'
  #     MARIADB_USER: 'yAKqwcWYAr9kzLdn__overload_test'
  #     MARIADB_ROOT_PASSWORD: 'F9pXgdTAwcWSxH4WnZYex3pLJmR947VZ__overload_test'
  #     MARIADB_ROOT_USER: 'root_F5g8H7F__overload_test'

  #   project:
  #     client_name: 'masamune__overload_test'
  #     dashed_domain: 'test-wordpress-masamune-fr__overload_test'
  #     # Docker recommanded notation: extension.site.subdomain.SOME-LABEL
  #     #   https://docs.docker.com/config/labels-custom-metadata/#key-format-recommendations
  #     labels_prefix: 'fr.masamune.test-wordpress__overload_test'
  #     maintainer: 'masamune.code@gmail.com__overload_test'
  #     name: 'test wordpress__overload_test'
  #     type: 'test__overload_test'

  #   traefik:
  #     # Ensure DNS are set accordingly to point towards host IP
  #     # This will point towards 'https://test-wordpress.masamune.fr/'
  #     public_uri: 'test-wordpress.masamune.fr__overload_test'
  #     # For router & middleware names generation
  #     # subDomain_domain_ext__stacktype
  #     uid: 'testWordpress_masamune_fr__wordpress__overload_test'

  #   wordpress:
  #     image: 'bitnami/wordpress:5__overload_test'
  #     WORDPRESS_TABLE_PREFIX: 'wp_PL9ZFfYp___overload_test'
  #     WORDPRESS_BLOG_NAME: "Sponge Bob's blog__overload_test"
  #     WORDPRESS_EMAIL: 'masamune.code@gmail.com__overload_test'
  #     WORDPRESS_FIRST_NAME: 'Bob__overload_test'
  #     WORDPRESS_LAST_NAME: 'Sponge__overload_test'
  #     # 50 chars length / NO SPECIAL CHARS, tends to not match when container is up
  #     WORDPRESS_USERNAME: 'ndj4E2rDbVeRkEHHcu9X7me3asqTNFmzwjKAhU9LbqpMb8Wbcf__overload_test'
  #     # 50 chars length / Wordpress recommandations : ! ? % ^ & ) / No no $ ' :"
  #     WORDPRESS_PASSWORD: 'ndj4E2r!bVeRkE?Hcu8%7me3as^TNFmzwjKAh)U9Lbqp&b8Wbcf__overload_test'

  roles:
    - wordpress-generate
...