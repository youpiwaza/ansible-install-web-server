---
### Crafts and tests
## Prevents me from commenting/uncommenting/forgetting on final production files ^^'

# ---
# Currently working on: Playbook 4 / Init core services / Set up reverse proxy Traefik
# ---

# You'll need the_builder_guy to have it's ssh key added to the local agent, cf. the_builder_guy generated documentation
# You'll need the_docker_guy  to have it's ssh key added to the local agent, cf. the_docker_guy  generated documentation

#### Da plan

### builder_guy
# Create /docker_peon/core/reverse-proxy/traefik/ folder if needed
# Copy template traefik.yml
# Create /docker_peon/tests/hellos folder
# Copy templates hello*.yml



### docker_guy
## Create public network
#   docker network create --driver=overlay --attachable traefik-public

## Create named volumes
# core-traefik-logs
#   /home/logs/traefik-debug.log
#     chown 1003:1003
#   /home/logs/traefik-access.log
#     chown 1003:1003

# core-traefik-https
#   /home/https/
#     chown 1003:1003

## Start traefik DC

## Start hellos
# start
# curl test
# stop

## Volumes tests
# core-traefik-logs > debug & access > not empty
# core-traefik-https > /home/https/acme.json > present & not empty


# ---

# Da execution

### builder_guy
# Install reverse proxy traefik compose files
- name: '{{ users.0.name }} / Install reverse proxy traefik files in /home/{{ users.3.name }}/'
  become: yes
  hosts: likorneWithCustomSSHPort
  # the_builder_guy / cf. /ansible/roles/users/vars/main.yml
  remote_user: '{{ users.0.name }}'
  vars_files:
  - defaults/main.yml
  - vars/main.yml
  - roles/users/defaults/main.yml
  - roles/users/vars/main.yml

  roles:
    - core-install-reverse-proxy

# ---

# ### docker_guy
# - name: '{{ users.2.name }} / Start and test reverse proxy traefik'
#   become: no
#   hosts: likorneWithCustomSSHPort

#   # Enforce container default security & good practices
#   #   Cf. ansible/50-ansible-containers-modules-defaults.yml

#   # the_docker_guy / cf. /ansible/roles/users/vars/main.yml
#   remote_user: '{{ users.2.name }}'
#   vars_files:
#   - defaults/main.yml
#   - roles/users/defaults/main.yml
#   - vars/main.yml
#   - roles/users/vars/main.yml

#   roles:
#     - core-init-reverse-proxy

# ---

...