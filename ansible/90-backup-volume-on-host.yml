---
### Backup a specific volume: Extract a specific folder, then archive it on host (.tar)
## docker_guy
# > ansible-playbook -i hostsWithCustomSSHPort 90-backup-volume-on-host.yml

# ðŸ”§ Variables must be properly filled:
# - folderToBackup  : The folder where the files are stored INSIDE the volume
# - volumeName      : identifier of the named volume

# ðŸ¤– Automated:
# - Name of the archive
# - Timestamp
# - Where the archive will be stored, cf. nomenclature-and-folder-tree.md
#     As a manual backup, it will be stored around ~/home/the-docker-guy/backups/volumes/{{ currentYear }}/manual-backup/{{ volumeName }}/...

# For more details, have a look at docker-commands-template.md###Create a backup

# You'll need the_docker_guy to have it's ssh key added to the local agent, cf. the_docker_guy generated documentation

- name: 'Backup a specific volume'
  become: no
  hosts: likorneWithCustomSSHPort
  # docker_guy / cf. /ansible/roles/users/vars/main.yml
  remote_user: '{{ users.2.name }}'
  vars:
    currentDateTime: "{{ ansible_date_time.date }}--{{ ansible_date_time.hour }}h{{ ansible_date_time.minute }}m{{ ansible_date_time.second }}s"
    currentYear: "{{ ansible_date_time.year }}"

    ## ðŸ”§ Edit variables here
    # cf. generated .yml file > volumes > target
    folderToBackup: '/var/log/'
    project:
      client_name: 'masamune'
      dashed_domain: 'manual-backups'
      type: 'test'
    volumeName: 'test---hello--masamune--fr---nginx--logs'
  vars_files:
  - defaults/main.yml
  - roles/users/defaults/main.yml
  - vars/main.yml
  - roles/users/vars/main.yml

  roles:
    - docker-volume-backup-on-host
...